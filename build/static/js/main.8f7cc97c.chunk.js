(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,n){e.exports=n(60)},48:function(e,t,n){},50:function(e,t,n){},52:function(e,t,n){},54:function(e,t,n){},56:function(e,t,n){},58:function(e,t,n){},60:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(18),o=n.n(i),c=n(1),s=n(2),l=n(4),u=n(3),d=n(5),m=n(20),h=n(11),p=n(7),y=n.n(p),f=n(8),b=n(9),x=n.n(b),v=x.a.create({baseURL:"https://afternoon-earth-75642.herokuapp.com/"}),E=n(19),w=new(n.n(E).a.Synth)({oscillator:{type:"pwm",modulationType:"sawtooth",modulationIndex:3,harmonicity:3.4},envelope:{attack:.003,decay:.2,sustain:.01,release:.01}}).toMaster();w.volume.value=0;var g=function(e){return w.volume.value=.5*e},O=function(e){w.triggerAttackRelease(e,.1)},k=Object(a.createContext)(),j={isMuted:!1,volume:-10},S=function(){var e=Object(f.a)(y.a.mark(function e(){var t;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.get("/leaderboards");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),A=function(e){var t=e.playerHeadPosition,n=e.boardSize,a=e.gridBlockSize,r=e.playerDirection,i=e.tailArr;if(!t)return!0;if(t.x<=0&&-1===r.x)return!0;if(t.x+a+1>=n&&1===r.x)return!0;if(t.y<=0&&r.y<0)return!0;if(t.y+a>=n&&r.y>0)return!0;for(var o=0;o<i.length-2;o++)if(i[o]===t.id)return!0},P=function(e){return!(!e.playerHeadPosition||e.playerHeadPosition.id!==e.pickupPosition.id)},M=function(e){var t=Math.round(Math.random()*e.gridArr.length);return e.gridArr[t]},N={isOnMobile:!1,isGameOver:!0,showMenu:!0,score:0,boardSize:300,gridBlockSize:25,gridRowNumItems:0,gridArr:[],playerDirection:{x:0,y:0},playerHeadPosition:{x:0,y:0,id:0},pickupPosition:{x:0,y:0,id:0},pickupValue:1,tailArr:[],playerName:"Player 1",leaderBoards:[],fps:10,interval:null,now:Date.now(),then:null,isMuted:j.isMuted,volume:j.volume},B=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state=N,n.setBorders=function(){var e=Object(f.a)(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.setState({gameBoardBorders:t});case 2:n.generateGrid();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.generateGrid=Object(f.a)(y.a.mark(function e(){var t,a,r,i,o,c;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=Math.round(n.state.boardSize/n.state.gridBlockSize),a=[],r=0;r<=t-1;r++)for(i=0;i<=t-1;i++)o=r*n.state.gridBlockSize,c=i*n.state.gridBlockSize,a.push({x:c,y:o,id:a.length});n.setState({gridArr:a,gridRowNumItems:t});case 4:case"end":return e.stop()}},e,this)})),n.setBoardSize=function(){if(window.innerHeight>window.innerWidth){var e=Math.round(99*window.innerWidth/100);n.setState({boardSize:e})}else{var t=Math.round(99*window.innerHeight/100);n.setState({boardSize:t})}},n.setPlayerDirection=function(e){n.setState({playerDirection:e})},n.centerPlayerPosition=function(){var e=Math.round(n.state.gridArr.length/2)+Math.round(n.state.gridBlockSize/2);n.setState({playerHeadPosition:n.state.gridArr[e+12]})},n.setPickupPosition=function(){var e=M(n.state);e&&e.id in n.state.tailArr?n.setPickupPosition():n.setState({pickupPosition:e})},n.generateTailArr=function(){if(n.state.playerHeadPosition){if(!n.state.tailArr.indexOf(n.state.playerHeadPosition.id)){var e=[].concat(Object(h.a)(n.state.tailArr),[n.state.playerHeadPosition.id]);e.length>n.state.score&&e.shift()}var t=[].concat(Object(h.a)(n.state.tailArr),[n.state.playerHeadPosition.id]);t.length>n.state.score&&t.shift(),n.setState({tailArr:t})}},n.setShowMenu=function(){n.state.showMenu?n.setState({showMenu:!1}):n.setState({showMenu:!0})},n.setPlayerName=function(e){N.playerName=e,n.setState({playerName:e,isGameOver:!1})},n.testIsOnMobile=function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?n.setState({isOnMobile:!0}):n.setState({isOnMobile:!1})},n.startAnimation=function(){n.setState({interval:1e3/n.state.fps,then:Date.now()}),n.step()},n.stopAnimation=function(){window.cancelAnimationFrame(n.step)},n.step=Object(f.a)(y.a.mark(function e(){var t,a,r,i,o;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.requestAnimationFrame(n.step),!n.state.showMenu){e.next=3;break}return e.abrupt("return");case 3:if(n.setState({now:Date.now()}),!(n.state.now-n.state.then>n.state.interval)){e.next=19;break}if(n.setState({then:n.state.now}),!A(n.state)){e.next=10;break}return n.state.isMuted||O("D3"),e.abrupt("return",n.reset());case 10:if(P(n.state)&&(t=n.state.score+n.state.pickupValue,n.state.isMuted||O("D4"),n.setPickupPosition(),n.setState({score:t})),-1===n.state.playerDirection.y&&(a=n.state.gridArr[n.state.playerHeadPosition.id-n.state.gridRowNumItems],n.setState({playerHeadPosition:a}),n.generateTailArr()),1===n.state.playerDirection.y&&(r=n.state.gridArr[n.state.playerHeadPosition.id+n.state.gridRowNumItems],n.setState({playerHeadPosition:r}),n.generateTailArr()),-1!==n.state.playerDirection.x){e.next=18;break}return i=n.state.gridArr[n.state.playerHeadPosition.id-1],e.next=17,n.setState({playerHeadPosition:i});case 17:n.generateTailArr();case 18:1===n.state.playerDirection.x&&(o=n.state.gridArr[n.state.playerHeadPosition.id+1],n.setState({playerHeadPosition:o}),n.generateTailArr());case 19:case"end":return e.stop()}},e,this)})),n.muteAudio=function(){n.state.isMuted?(j.isMuted=!1,n.setState({isMuted:!1})):(j.isMuted=!0,n.setState({isMuted:!0}))},n.adjustAudioVolume=function(e){var t=n.state.volume+e;t>=-60&&t<=40&&(N.volume=t,g(t),n.setState({volume:t}))},n.reset=Object(f.a)(y.a.mark(function e(){var t,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.stopAnimation(),!(n.state.score>0)){e.next=5;break}return t={name:n.state.playerName,score:n.state.score},e.next=5,x.a.post("https://afternoon-earth-75642.herokuapp.com/leaderboards",t);case 5:return e.next=7,n.setState(N);case 7:return e.next=9,n.setState({isMuted:j.isMuted});case 9:return S().then(function(e){n.setState({leaderBoards:e})}),e.next=12,n.testIsOnMobile();case 12:return e.next=14,n.setBoardSize();case 14:return e.next=16,n.state.boardSize;case 16:return e.t0=e.sent,a=e.t0/20,e.next=20,n.setState({gridBlockSize:a});case 20:return e.next=22,n.generateGrid();case 22:return e.next=24,n.setPickupPosition();case 24:return e.next=26,n.setState({playerDirection:{x:0,y:0}});case 26:return e.next=28,n.centerPlayerPosition();case 28:n.startAnimation();case 29:case"end":return e.stop()}},e,this)})),n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",function(){e.reset()}),this.reset()}},{key:"render",value:function(){return r.a.createElement(k.Provider,{value:Object(m.a)({},this.state,{setBorders:this.setBorders,setPlayerDirection:this.setPlayerDirection,setShowMenu:this.setShowMenu,setPlayerName:this.setPlayerName,muteAudio:this.muteAudio,adjustAudioVolume:this.adjustAudioVolume})},this.props.children)}}]),t}(r.a.Component),C=k,D=(n(48),n(50),function(e,t,n,a){switch(e.which){case 87:return 0!==t.y?t:{x:0,y:-1,id:n.id-a-1};case 83:return 0!==t.y?t:{x:0,y:1,id:n.id+a+1};case 65:return 0!==t.x?t:{x:-1,y:0,id:n.id-1};case 68:return 0!==t.x?t:{x:1,y:0,id:n.id+1};default:return t}}),T=function(e,t,n,a){switch(e){case"UP":return 0!==t.y?t:{x:0,y:-1,id:n.id-a-1};case"DOWN":return 0!==t.y?t:{x:0,y:1,id:n.id+a+1};case"LEFT":return 0!==t.x?t:{x:-1,y:0,id:n.id-1};case"RIGHT":return 0!==t.x?t:{x:1,y:0,id:n.id+1};default:return t}},H=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).handleInput=function(e){if(n.context.showMenu)n.context.setPlayerDirection({x:0,y:0});else{var t=D(e,n.context.playerDirection,n.context.playerHeadPosition,n.context.gridRowNumItems);t.id&&n.context.setPlayerDirection({x:t.x,y:t.y})}},n.renderPlayerPosition=function(){if(!n.context.playerHeadPosition)return r.a.createElement("div",null);var e=n.context.gridArr[n.context.playerHeadPosition.id];return e&&e.id?e:n.context.playerHeadPosition},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("keydown",function(t){e.handleInput(t)})}},{key:"render",value:function(){return r.a.createElement("div",{className:"nes-btn is-primary",style:{width:this.context.gridBlockSize,height:this.context.gridBlockSize,position:"absolute",left:this.renderPlayerPosition().x,top:this.renderPlayerPosition().y}})}}]),t}(r.a.Component);H.contextType=C;var z=H,I=(n(52),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).renderTail=function(e){return e.map(function(t,a){return t===t[e.length]?r.a.createElement("div",null):r.a.createElement("div",{className:"nes-btn is-warning",key:a,style:{height:n.context.gridBlockSize,width:n.context.gridBlockSize,position:"absolute",top:n.context.gridArr[t].y,left:n.context.gridArr[t].x}})})},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,this.renderTail(this.context.tailArr))}}]),t}(r.a.Component));I.contextType=C;var R=I,L=(n(54),function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"nes-btn is-success",style:{width:this.context.gridBlockSize,height:this.context.gridBlockSize,position:"absolute",top:this.context.pickupPosition.y,left:this.context.pickupPosition.x}})}}]),t}(r.a.Component));L.contextType=C;var U=L,F=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"nes-container is-rounded",style:{width:"fit-content"}},r.a.createElement("h5",null,this.context.playerName),"SCORE: ",this.context.score)}}]),t}(r.a.Component);F.contextType=C;var G=F,V=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{ref:function(t){return e.divElement=t},className:"nes-container is-dark is-rounded",style:{width:this.context.boardSize,height:this.context.boardSize,margin:"0"}},r.a.createElement(G,null),r.a.createElement(U,null),r.a.createElement(R,null),r.a.createElement(z,null))}}]),t}(r.a.Component);V.contextType=C;var W=V,J=(n(56),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).handleUserInput=function(e){var t=T(e,n.context.playerDirection,n.context.playerHeadPosition,n.context.gridRowNumItems);t.id&&n.context.setPlayerDirection({x:t.x,y:t.y})},n.renderControls=function(){return!n.context.isOnMobile||n.context.showMenu?r.a.createElement("div",null):r.a.createElement("table",{className:"nes-table is-bordered is-centered is-dark controls-table",style:{width:n.context.boardSize}},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null),r.a.createElement("td",null,r.a.createElement("button",{onTouchStart:function(){n.handleUserInput("UP")},className:"nes-btn is-primary up controls-btn"},"\u2191")),r.a.createElement("td",null)),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("button",{onTouchStart:function(){n.handleUserInput("LEFT")},className:"nes-btn is-primary left controls-btn"},"\u2190")),r.a.createElement("td",null),r.a.createElement("td",null,r.a.createElement("button",{onTouchStart:function(){n.handleUserInput("RIGHT")},className:"nes-btn is-primary right controls-btn"},"\u2192"))),r.a.createElement("tr",null,r.a.createElement("td",null),r.a.createElement("td",null,r.a.createElement("button",{onTouchStart:function(){n.handleUserInput("DOWN")},className:"nes-btn is-primary down controls-btn"},"\u2193")),r.a.createElement("td",null))))},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:" nes-container controls"},this.renderControls())}}]),t}(r.a.Component));J.contextType=C;var _=J,q=(n(58),function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("keypress",function(t){switch(t.which){case 13:return e.context.setShowMenu();default:return null}})}},{key:"renderModal",value:function(){var e=this;if(!this.context.showMenu)return r.a.createElement("div",null);var t="nes-container modal";return this.context.showMenu||(t="nes-container modal hidden"),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t,style:{width:"100vw",minHeight:"100vh"}},r.a.createElement("h1",{style:{textAlign:"center"}},"SNAAAAAKE"),r.a.createElement("h4",{style:{textAlign:"center"}},r.a.createElement("a",{href:"https://github.com/CannonFodderr/reactsnake"},"Fork me on GitHub")),r.a.createElement("button",{style:{width:"100%"},className:"nes-btn is-error",onClick:function(){e.context.setShowMenu()}},r.a.createElement("span",{className:"start-btn"},"START")),this.props.children,r.a.createElement("hr",null),r.a.createElement("h4",null,"By",r.a.createElement("a",{href:"https://www.linkedin.com/in/idan-izhaki/"}," Idan Izhaki"))))}},{key:"render",value:function(){return r.a.createElement("div",null,this.renderModal())}}]),t}(r.a.Component));q.contextType=C;var K=q,Q=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"nes-field"},r.a.createElement("label",{htmlFor:"playerName",style:{textAlign:"center"}},"Enter your name:"),r.a.createElement("input",{className:"nes-input",name:"playerName",style:{textAlign:"center"},placeholder:this.props.playerName,onChange:function(t){e.context.setPlayerName(t.target.value)},maxLength:"8"}))}}]),t}(r.a.Component);Q.contextType=C;var X=Q,Y=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h5",null,r.a.createElement("i",{className:"nes-logo"}),"MOVEMENT"),r.a.createElement("ul",null,r.a.createElement("li",null," Use W A S D with keyboard "),r.a.createElement("li",null," Use Arrows on screen with touch devices ")))}}]),t}(r.a.Component),Z=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"renderLeaderBoards",value:function(){return 0===this.context.leaderBoards.length?r.a.createElement("tr",{style:{textAlign:"center",background:"#3e3e"}},r.a.createElement("td",null,"Loading...")):this.context.leaderBoards.map(function(e,t){return 0===t?r.a.createElement("tr",{key:e._id,style:{textAlign:"center",background:"#3e3e"}},r.a.createElement("td",null,e.name),r.a.createElement("td",null," ",e.score)):r.a.createElement("tr",{key:e._id,style:{textAlign:"center"}},r.a.createElement("td",null,e.name),r.a.createElement("td",null," ",e.score))})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h3",{style:{textAlign:"center"}},"LEADERBOARDS"),r.a.createElement("table",{className:"nes-table is-centered is-bordered",style:{width:"100%"}},r.a.createElement("tbody",null,r.a.createElement("tr",{style:{background:"#000",color:"#fff",borderRadius:"25%",letterSpacing:"0.5em"}},r.a.createElement("th",null,"NAME"),r.a.createElement("th",null,"SCORE")),this.renderLeaderBoards())))}}]),t}(r.a.Component);Z.contextType=C;var $=Z,ee=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).renderCheckBox=function(){return r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",className:"nes-checkbox",checked:n.context.isMuted,onChange:function(){n.context.muteAudio()}}),r.a.createElement("span",null,"Mute Sound"))},n.renderControls=function(){return n.context.isMuted?r.a.createElement("div",null,n.renderCheckBox()):r.a.createElement("div",null,n.renderCheckBox(),r.a.createElement("div",null,r.a.createElement("button",{className:"nes-btn",onClick:function(){n.context.adjustAudioVolume(-5)}},"-"),r.a.createElement("button",{className:"nes-btn",onClick:function(){n.context.adjustAudioVolume(5)}},"+"),r.a.createElement("progress",{className:"nes-progress is-primary",value:n.context.volume+60,max:"100"})))},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"nes-container"},r.a.createElement("h4",{className:"title"},"Audio Setup"),this.renderControls())}}]),t}(r.a.Component);ee.contextType=C;var te=ee,ne=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(B,null,r.a.createElement(W,null),r.a.createElement(_,null),r.a.createElement(K,null,r.a.createElement("div",null,r.a.createElement(X,{playerName:"Player 1"}),r.a.createElement(Y,null),r.a.createElement(te,null),r.a.createElement($,null)))))}}]),t}(r.a.Component);o.a.render(r.a.createElement(ne,null),document.getElementById("root"))}},[[21,2,1]]]);
//# sourceMappingURL=main.8f7cc97c.chunk.js.map